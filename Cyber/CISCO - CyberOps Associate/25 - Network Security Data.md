**Alert data** consists of messages generated by intrusion prevention systems (IPSs) or intrusion detection systems (IDSs) in response to traffic that violates a rule or matches the signature of a known exploit.

**Session data** is a record of a conversation between two network endpoints, which are often a client and a server. The server could be inside the enterprise network or at a location accessed over the internet.

**Transaction data** consists of the messages that are exchanged during network sessions. These transactions can be viewed in packet capture transcripts. Device logs kept by servers also contain information about the transactions that occur between clients and servers.

**Full packet captures** are the most detailed network data that is generally collected. Because of the amount of detail, they are also the most storage and retrieval intensive types of data used in NSM.

**Extracted content** can be recovered from full packet captures and analyzed for malware or user behavior that violates business and security policies.

Like session data, **statistical data** is about network traffic. Statistical data is created through the analysis of other forms of network data. Conclusions can be made that describe or predict network behavior from these analysis.

1. **Full packet capture** data includes detailed protocol and payload information for all traffic on a network segment.  
2. **Statistical data** is used to describe and analyze network flow or performance data.  
3. **Transaction data** includes device-specific server and host logs.  
4. **Extracted content** includes files that are attached to emails or that were downloaded from the internet.  
5. **Session data** contains details of network flows including the 5-tuples the amount of data transmitted and the duration of data transmission.  
6. **Alert data** is generated by IPS or IDS devices when suspicious traffic is detected.
****
## End Device Logs
Microsoft Windows host logs are visible locally through Event Viewer. Event Viewer keeps five types of logs:
- **Application logs** - These contain events logged by various applications.
- **System logs** - These include events regarding the operation of drivers, processes, and hardware.
- **Setup logs** - These record information about the installation of software, including Windows updates.
- **Security logs** - These record events related to security, such as logon attempts and operations related to file or object management and access.
- **Command-line logs** - Attackers who have gained access to a system, and some types of malware, execute commands from the command-line interface (CLI) rather than a GUI. Logging command line execution will provide visibility into this type of incident.

On Windows computers, security logging is carried out by the Local Security Authority Subsystem Service (LSASS), which is also responsible for enforcing security policies on a Windows host.

The table explains the meaning of the five Windows host log event types.

|Event Type|Description|
|---|---|
|Error|An error is an event that indicates a significant problem such as loss of data or loss of functionality. For example, if a service fails to load during startup, an error event is logged.|
|Warning|A Warning is an event that is not necessarily significant but may indicate a possible future problem. For example, when disk space is low, a warning event is logged. If an application can recover from an event without loss of functionality or data, it can generally classify the event as a warning event.|
|Information|An information event describes the successful operation of an application, driver, or service. For example, when a network driver loads successfully, it may be appropriate to log an information event. Note that it is generally inappropriate for a desktop application to log an event each time it starts.|
|Success Audit|A success audit is an event that records an audited security access attempt that is successful. For example, a user’s successful attempt to log on to the system is logged as a success audit event.|
|Failure Audit|A failure audit is an event that records an audited security access attempt that fails. For example, if a user tries to access a network drive and fails, the attempt is logged as a failure audit event.|
****
### Syslog
Syslog messages can be sent via UDP (port 514) and/or TCP (typically, port 5000). The Syslog sender sends a small (less than 1KB) text message to the Syslog receiver.

The full format of a Syslog message that is seen on the network has three distinct parts.
- PRI (priority)
- HEADER
- MSG (message text)

![[Pasted image 20250307110320.png]]
Facility codes between 15 and 23 (local0-local7) are not assigned a keyword or name. 

Facilities in syslogs are used to categorize log messages based on their sources or purposes. They provide a way to differentiate between various components of a Linux system.
![[Pasted image 20250307112440.png]]

![[Pasted image 20250307112448.png]]

**Priority = (Facility * 8) + Severity**
****
### Server Logs
###### Apache Access Log
```
203.0.113.127 – dsmith [10/Oct/2016:10:26:57 - 0500] "GET /logo_sm.gif HTTP/1.0" 200 2254 "http://www.example.com/links.html" "Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0"
```
###### IIS Access Log
```
6/14/2016, 16:22:43, 203.0.113.24, -, W3SVC2, WEB3, 198.51.100.10, 80, GET, /home.htm, -, 200, 0, 15321, 159, 15, HTTP/1.1, Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0), -, http://www.example.com
```

### SIEM and Log Collection
Security Information and Event Management (SIEM) technology is used in many organizations to provide real-time reporting and long-term analysis of security events,

![[Pasted image 20250307113022.png]]

- **Log collection** - Event records from sources throughout the organization provide important forensic information and help to address compliance reporting requirements.
- **Normalization** - This maps log messages from different systems into a common data model, enabling the organization to connect and analyze related events, even if they are initially logged in different source formats.
- **Correlation** - This links logs and events from disparate systems or applications, speeding detection of and reaction to security threats.
- **Aggregation** - This reduces the volume of event data by consolidating duplicate event records.
- **Reporting** - This presents the correlated, aggregated event data in real-time monitoring and long-term summaries, including graphical interactive dashboards.
- **Compliance** - This is reporting to satisfy the requirements of various compliance regulations.

****
## ## Network Logs

### NetFlow
NetFlow is a protocol that was developed by Cisco as a tool for network troubleshooting and session-based accounting

Traditionally, an IP Flow is based on a set of 5 to 7 IP packet attributes flowing in a single direction. A flow consists of all packets transmitted until the TCP conversation terminates. IP Packet attributes used by NetFlow are:
- IP source address
- IP destination address
- Source port
- Destination port
- Layer 3 protocol type
- Class of Service
- Router or switch interface

### Application Visibility and Control
The Cisco Application Visibility and Control (AVC) system, which is shown in the figure, combines multiple technologies to recognize, analyze, and control over 1000 applications. These include voice and video, email, file sharing, gaming, peer-to-peer (P2P), and cloud-based applications. AVC uses Cisco next-generation network-based application recognition version 2 (NBAR2), also known as Next-Generation NBAR, to discover and classify the applications in use on the network. The NBAR2 application recognition engine supports over 1000 network applications. Identify applications using L3 to L7 data
###  Content Filter Logs
Devices that provide content filtering, such as the Cisco Email Security Appliance (ESA) and the Cisco Web Security Appliance (WSA), provide a wide range of functionalities for security monitoring. Logging is available for many of these functionalities.

WSA devices offer a similar depth of functioning. WSA effectively acts as a web proxy, meaning that it logs all inbound and outbound transaction information for HTTP traffic. These logs can be quite detailed and are customizable
### Logging from cisco devices
Cisco security devices can be configured to submit events and alerts to security management platforms using SNMP or syslog.
### Proxy logs
Web proxies provide data that helps determine whether responses from the web were generated in response to legitimate requests or have been manipulated to appear to be responses but are in fact exploits. It is also possible to use web proxies to inspect outgoing traffic as means of data loss prevention (DLP). DLP involves scanning outgoing traffic to detect whether the data that is leaving the web contains sensitive, confidential, or secret information. Examples of popular web proxies are Squid, CCProxy, Apache Traffic Server, and WinGate.
###### DNS Proxy log Example
```
1265939281.764     19478 172.16.167.228 TCP_MISS/200 864 GET http://www.example.com//images/home.png - NONE/- image/png
```

Cisco Umbrella, formerly OpenDNS, offers a hosted DNS service that extends the capability of DNS to include security enhancements. Rather than organizations hosting and maintaining block listing, phishing protection, and other DNS-related security, Cisco Umbrella provides these protections in its own DNS service.
### Next-Generation Firewalls
Next-Generation or NextGen Firewall devices extend network security beyond IP addresses and Layer 4 port numbers to the application layer and beyond. 

Cisco’s line of NextGen Firewall devices (NGFW) use Firepower Services to consolidate multiple security layers into a single platform.
 Firepower services include application visibility and control, Firepower Next-Generation IPS (NGIPS), reputation and category-based URL filtering, and Advanced Malware Protection (AMP).

Common NGFW events include:
- **Connection Event** - Connection logs contain data about sessions that are detected directly by the NGIPS. Connection events include basic connection properties such as timestamps, source and destination IP addresses, and metadata about why the connection was logged, such as which access control rule logged the event.
- **Intrusion Event** - The system examines the packets that traverse the network for malicious activity that could affect the availability, integrity, and confidentiality of a host and its data. When the system identifies a possible intrusion, it generates an intrusion event, which is a record of the date, time, type of exploit, and contextual information about the source of the attack and its target.
- **Host or Endpoint Event** - When a host appears on the network it can be detected by the system and details of the device hardware, IP addressing, and the last known presence on the network can be logged.
- **Network Discovery Event** - Network discovery events represent changes that have been detected in the monitored network. These changes are logged in response to network discovery policies that specify the kinds of data to be collected, the network segments to be monitored, and the hardware interfaces of the device that should be used for event collection.
- **Netflow Event** -Network discovery can use a number of mechanisms, one of which is to use exported NetFlow flow records to generate new events for hosts and servers.


1. **Intrusion** events are logged when malicious activity occurs.  
2. **Host or endpoint events** are logged when a computer appears on the network.  
3. **NetFlow events** are derived from exported flow records that indicate that a new host has joined the network.  
4. **Connection events** concern session between hosts that were discovered by the NextGen Firewall directly.  
5. **Network Discovery** events are logged when changes occur to hosts or application that are known on the network.
























































































































